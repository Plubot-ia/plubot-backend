2025-07-23 23:41:34,730 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:34,733 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:34,840 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:34] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:35,422 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:36,371 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:36,372 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:36,821 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:36,821 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:36,857 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:36] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:36,993 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:36] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:37,056 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:37,383 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:37,384 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:37,951 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:37,952 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:38,072 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:38,136 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:38] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:38,195 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:38,195 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:38,528 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:38,529 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:38,747 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:38] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:39,221 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:39,979 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:39,980 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:40,155 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:40] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:40,744 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:40,745 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:41,362 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:41,362 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:41,453 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:41,536 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:41] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:41,968 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:41,969 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:42,144 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:42] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:42,436 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:42,437 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:42,717 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:42,718 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:42,892 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:42] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:43,128 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:43,905 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:43] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:44,089 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:44,090 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:44,263 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:44] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:44,432 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:44,433 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:45,291 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:45,802 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:45,803 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:45,872 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:45,873 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:46,042 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:46] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:46,487 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:47,006 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:47,006 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:47,183 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:47] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:47,330 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:47,330 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:47,502 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:47] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:47,576 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'animated': True, 'id': '10517', 'label': '', 'source': 'start-e005d67f', 'target': 'message-bba9c837', 'type': 'default'}, {'animated': True, 'id': '10518', 'label': '', 'source': 'message-bba9c837', 'target': 'decision-290a2fc8', 'type': 'eliteEdge'}, {'animated': True, 'id': '10519', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-4d01e941-7227-4737-9d02-317a99523646', 'target': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10520', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'target': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10521', 'label': '', 'source': 'decision-290a2fc8', 'sourceHandle': 'output-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'target': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'targetHandle': 'target', 'type': 'eliteEdge'}, {'animated': True, 'id': '10522', 'label': '', 'source': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10523', 'label': '', 'source': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}, {'animated': True, 'id': '10524', 'label': '', 'source': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'sourceHandle': 'source', 'target': 'end-11a6ac5c', 'type': 'eliteEdge'}]}
2025-07-23 23:41:47,577 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=8, name='N/A'
2025-07-23 23:41:48,198 - api.flow_api - INFO - Cache miss for key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8.
2025-07-23 23:41:48,265 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=8, name='None'
2025-07-23 23:41:48,789 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:48,790 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:48,965 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:48] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:49,211 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Cargando nombre...', 'nodes': [], 'edges': [], 'viewport': {'x': 0, 'y': 0, 'zoom': 1}}
2025-07-23 23:41:49,211 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=0, edges_count=0, name='N/A'
2025-07-23 23:41:49,614 - api.flow_api - INFO - DB query for flows returned 28 items.
2025-07-23 23:41:49,704 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:49] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:49,786 - api.flow_api - INFO - DB query for edges returned 8 items.
2025-07-23 23:41:49,787 - api.flow_api - INFO - Flow data for plubot 252 stored in cache with key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8
2025-07-23 23:41:49,931 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=0, edges_count=0, name='None'
2025-07-23 23:41:50,133 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:50] "GET /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:50,236 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Cargando nombre...', 'nodes': [], 'edges': [], 'viewport': {'x': 0, 'y': 0, 'zoom': 1}}
2025-07-23 23:41:50,236 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=0, edges_count=0, name='N/A'
2025-07-23 23:41:50,927 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=0, edges_count=0, name='None'
2025-07-23 23:41:56,285 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:56] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-07-23 23:41:56,708 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:41:56,709 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:41:56,881 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:56] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:41:57,876 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:57] "POST /api/auth/logout HTTP/1.1" 200 -
2025-07-23 23:41:59,822 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:41:59] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-07-23 23:42:00,921 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:00] "POST /api/auth/login HTTP/1.1" 200 -
2025-07-23 23:42:01,323 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:01,324 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:01,496 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:01] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:06,273 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:06] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:06,793 - api.flow_api - INFO - Cache miss for key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8.
2025-07-23 23:42:07,303 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:07] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:07,469 - api.flow_api - INFO - DB query for flows returned 21 items.
2025-07-23 23:42:07,641 - api.flow_api - INFO - DB query for edges returned 0 items.
2025-07-23 23:42:07,641 - api.flow_api - INFO - Flow data for plubot 252 stored in cache with key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8
2025-07-23 23:42:07,824 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Cargando nombre...', 'nodes': [], 'edges': []}
2025-07-23 23:42:07,825 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=0, edges_count=0, name='N/A'
2025-07-23 23:42:07,983 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:07] "GET /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:08,923 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=0, edges_count=0, name='None'
2025-07-23 23:42:09,633 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 125}], 'edges': []}
2025-07-23 23:42:09,635 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:10,332 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:10,641 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 125}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 125}], 'edges': []}
2025-07-23 23:42:10,642 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:10,849 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:10,850 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:11,024 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:11] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:11,326 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:11,838 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:11,838 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:12,014 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:12] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:13,034 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:13] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:13,556 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:13,557 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:14,242 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:14,558 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:14,560 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:14,758 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:14,759 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:14,847 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:14,847 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:14,938 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:14] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:15,019 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:15] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:15,250 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:16,153 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:16,153 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:16,326 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:16] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:16,554 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:16,555 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:17,865 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:17,865 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:18,018 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:18,352 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:18] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:18,536 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:18,536 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:18,553 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:18,743 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:18] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:18,873 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:18,874 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:19,067 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:19,067 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:19,249 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:19] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:19,565 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:20,081 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:20,081 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:20,634 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:20] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:20,791 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:20,792 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:21,490 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:22,014 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:22,015 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:22,173 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:22,175 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:22,187 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:22] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:22,861 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:23,375 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:23,375 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:23,546 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:23] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:24,139 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:24,140 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:24,570 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:24] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:24,836 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:25,093 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:25,095 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:25,353 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:25,354 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:25,527 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:25] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:26,153 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:26,673 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:26,673 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:26,846 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:26] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:27,066 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:27,068 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:27,750 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:28,643 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:28,643 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:28,772 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:28,774 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:28,816 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:28] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:29,837 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:29] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:29,851 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:30,376 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:30,377 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:30,552 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:30] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:30,735 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:30,736 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:31,426 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:31,945 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:31,945 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:32,090 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:32,091 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:32,117 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:32] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:33,164 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:33,656 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:33,657 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:34,062 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:34,063 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:34,237 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:34] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:34,342 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:34,663 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:34,664 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:34,864 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:34,864 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:35,038 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:35] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:35,350 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:36,061 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:36] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:36,449 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:36,449 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:36,582 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:36,584 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:36,622 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:36] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:37,278 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:37,802 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:37,803 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:37,977 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:37] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:38,162 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:38,164 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:39,232 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:39,518 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:39,519 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:39,755 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:39,755 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:39,926 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:39] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:40,211 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:41,107 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:41,107 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:41,281 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:41] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:41,463 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:41,465 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:42,153 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:42,299 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:42] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:42,667 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:42,667 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:42,819 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:42,820 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:42,839 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:42] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:43,661 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:44,212 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:44,214 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:44,387 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:44] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:44,388 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:44,389 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:45,085 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:45,629 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:45,630 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:45,804 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:45] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:45,929 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:45,930 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:46,616 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:47,129 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:47,130 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:47,302 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:47] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:47,343 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:47,344 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:48,052 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:48,317 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:48] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:48,566 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:48,567 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:48,739 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:48] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:48,837 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:48,837 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:49,518 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:50,029 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:50,030 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:50,202 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:50] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:50,283 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:50,284 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=21, edges_count=0, name='N/A'
2025-07-23 23:42:50,977 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=21, edges_count=0, name='None'
2025-07-23 23:42:51,491 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:51,491 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:51,664 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:51] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:51,874 - api.flow_api - INFO - Cache miss for key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8.
2025-07-23 23:42:52,560 - api.flow_api - INFO - DB query for flows returned 14 items.
2025-07-23 23:42:52,733 - api.flow_api - INFO - DB query for edges returned 0 items.
2025-07-23 23:42:52,733 - api.flow_api - INFO - Flow data for plubot 252 stored in cache with key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8
2025-07-23 23:42:52,898 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Cargando nombre...', 'nodes': [], 'edges': [], 'viewport': {'x': 0, 'y': 0, 'zoom': 1}}
2025-07-23 23:42:52,899 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=0, edges_count=0, name='N/A'
2025-07-23 23:42:53,080 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:53] "GET /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:53,586 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=0, edges_count=0, name='None'
2025-07-23 23:42:54,240 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:54] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:55,143 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:55,144 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:42:55,768 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:55,769 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:42:55,839 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:42:56,451 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:42:56,779 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:56,780 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:42:56,794 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:56,795 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:56,965 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:56,965 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:56,970 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:56] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:57,141 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:57] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:57,476 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:42:57,997 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:57,997 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:42:58,170 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:42:58] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:42:58,688 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:58,688 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:42:59,388 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:42:59,712 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:42:59,713 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:42:59,931 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:42:59,931 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:00,104 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:00] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:00,401 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:43:00,921 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:00,921 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:01,095 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:01] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:01,889 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:01,889 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:02,061 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:02] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:03,083 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:03] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:03,607 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:43:03,608 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:43:04,292 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:43:04,659 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:43:04,660 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:43:04,803 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:04,804 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:04,977 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:04] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:05,724 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:43:06,239 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:06,239 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:06,413 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:06] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:06,552 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:43:06,553 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:43:07,958 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:43:07,958 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=14, edges_count=0, name='N/A'
2025-07-23 23:43:08,025 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:43:08,456 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:08] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:08,652 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=14, edges_count=0, name='None'
2025-07-23 23:43:08,939 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:08,939 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:08,970 - api.flow_api - INFO - Cache miss for key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8.
2025-07-23 23:43:09,113 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:09] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:09,171 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:09,172 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:09,345 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:09] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:09,479 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:09] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:09,486 - api.flow_api - INFO - DB query for flows returned 7 items.
2025-07-23 23:43:09,657 - api.flow_api - INFO - DB query for edges returned 0 items.
2025-07-23 23:43:09,657 - api.flow_api - INFO - Flow data for plubot 252 stored in cache with key flow:252:3d70130104a259d52b8698d2cf836f6162d015a5fd078344d59b1e1aeeff65f8
2025-07-23 23:43:09,997 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:09] "GET /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:10,033 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Cargando nombre...', 'nodes': [], 'edges': [], 'viewport': {'x': 0, 'y': 0, 'zoom': 1}}
2025-07-23 23:43:10,033 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=0, edges_count=0, name='N/A'
2025-07-23 23:43:10,718 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=0, edges_count=0, name='None'
2025-07-23 23:43:11,670 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:43:11,671 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=0, name='N/A'
2025-07-23 23:43:12,429 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=0, name='None'
2025-07-23 23:43:12,679 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': []}
2025-07-23 23:43:12,680 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=0, name='N/A'
2025-07-23 23:43:12,940 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:12,940 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:13,113 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:13] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:13,374 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=0, name='None'
2025-07-23 23:43:13,898 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:13,898 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:14,073 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:14] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:15,091 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:15] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:15,617 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:15,617 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:16,012 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:16,013 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:16,185 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:16] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:16,305 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:16,614 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:16,615 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:17,297 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:17,721 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:17,722 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:18,194 - services.cache_service - INFO - Caché de flujo invalidada para plubot: 252
2025-07-23 23:43:18,194 - api.flow_api - INFO - Flujo actualizado para plubot 252 por usuario 72
2025-07-23 23:43:18,367 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:18] "PATCH /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:18,408 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:18,731 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:18,732 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:19,090 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.750346, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.750346, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 18, 750346), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:19,092 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.750346, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.750346, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 18, 750346), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:19,094 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.750346, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.750346, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 18, 750346), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:19,181 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20408, 20411, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.841767, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20408, 20411, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.841767, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET source_flow_id=%(source_flow_id)s, target_flow_id=%(target_flow_id)s, edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'source_flow_id': 20408, 'target_flow_id': 20411, 'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 18, 841767), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:19,187 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20408, 20411, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.841767, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20408, 20411, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.841767, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET source_flow_id=%(source_flow_id)s, target_flow_id=%(target_flow_id)s, edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'source_flow_id': 20408, 'target_flow_id': 20411, 'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 18, 841767), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:19,190 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20408, 20411, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.841767, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20408, 20411, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:18.841767, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET source_flow_id=%(source_flow_id)s, target_flow_id=%(target_flow_id)s, edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'source_flow_id': 20408, 'target_flow_id': 20411, 'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 18, 841767), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:19,269 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:19] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:19,364 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:19] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:19,430 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:20,373 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:20] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:20,502 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:19.777032, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:19.777032, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 19, 777032), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:20,504 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:19.777032, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:19.777032, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 19, 777032), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:20,506 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:19.777032, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:19.777032, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 19, 777032), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:20,681 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:20] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:20,892 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:20,893 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:21,577 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:22,216 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:22,216 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:22,258 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:21.919642, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:21.919642, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 21, 919642), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:22,259 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:21.919642, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:21.919642, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 21, 919642), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:22,263 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:21.919642, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:21.919642, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 21, 919642), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:22,439 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:22] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:22,897 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:23,584 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:23.242811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:23.242811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 23, 242811), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:23,586 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:23.242811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:23.242811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 23, 242811), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:23,589 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:23.242811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:23.242811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 23, 242811), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:23,764 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:23] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:23,969 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:23,970 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:24,655 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:25,299 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:25,299 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:25,383 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:25.041587, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:25.041587, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 25, 41587), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:25,385 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:25.041587, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:25.041587, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 25, 41587), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:25,389 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:25.041587, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:25.041587, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 25, 41587), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:25,566 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:25] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:25,983 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:26,587 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:26] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:26,667 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:26.327614, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:26.327614, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 26, 327614), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:26,670 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:26.327614, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:26.327614, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 26, 327614), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:26,672 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:26.327614, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:26.327614, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 26, 327614), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:26,844 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:26] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:27,111 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:27,111 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:27,809 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:28,463 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:28,463 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:28,537 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:28.165599, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:28.165599, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 28, 165599), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:28,540 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:28.165599, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:28.165599, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 28, 165599), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:28,543 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:28.165599, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:28.165599, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 28, 165599), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:28,721 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:28] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:29,148 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:29,856 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:29.492605, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:29.492605, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 29, 492605), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:29,860 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:29.492605, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:29.492605, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 29, 492605), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:29,863 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:29.492605, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:29.492605, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 29, 492605), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:30,037 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:30] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:30,304 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:30,305 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:30,993 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:31,600 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:31,601 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:31,680 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:31.338911, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:31.338911, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 31, 338911), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:31,684 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:31.338911, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:31.338911, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 31, 338911), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:31,686 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:31.338911, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:31.338911, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 31, 338911), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:31,861 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:31] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:32,283 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:32,883 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:32] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:32,965 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:32.626543, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:32.626543, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 32, 626543), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:32,968 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:32.626543, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:32.626543, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 32, 626543), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:32,972 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:32.626543, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:32.626543, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 32, 626543), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:33,146 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:33] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:33,401 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:33,403 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:34,090 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:34,689 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:34,690 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:34,775 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:34.434847, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:34.434847, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 34, 434847), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:34,779 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:34.434847, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:34.434847, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 34, 434847), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:34,781 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:34.434847, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:34.434847, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 34, 434847), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:34,955 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:34] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:35,383 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:36,087 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:35.74105, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:35.74105, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 35, 741050), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:36,090 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:35.74105, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:35.74105, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 35, 741050), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:36,093 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:35.74105, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:35.74105, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 35, 741050), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:36,270 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:36] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:36,496 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:36,497 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:37,188 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:37,815 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:37,816 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:37,874 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:37.533716, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:37.533716, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 37, 533716), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:37,877 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:37.533716, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:37.533716, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 37, 533716), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:37,880 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:37.533716, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:37.533716, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 37, 533716), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:38,054 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:38] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:38,508 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:39,074 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:39] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:39,194 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:38.85324, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:38.85324, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 38, 853240), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:39,196 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:38.85324, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:38.85324, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 38, 853240), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:39,198 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:38.85324, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:38.85324, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 38, 853240), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:39,376 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:39] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:39,602 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:39,602 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:40,370 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:40,923 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:40,923 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:41,061 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:40.717306, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:40.717306, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 40, 717306), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:41,065 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:40.717306, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:40.717306, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 40, 717306), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:41,068 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:40.717306, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:40.717306, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 40, 717306), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:41,241 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:41] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:41,604 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:42,285 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:41.946057, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:41.946057, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 41, 946057), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:42,290 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:41.946057, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:41.946057, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 41, 946057), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:42,292 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:41.946057, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:41.946057, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 41, 946057), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:42,465 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:42] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:42,775 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:42,775 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:43,467 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:43,998 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:43,999 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:44,161 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:43.81753, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:43.81753, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 43, 817530), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:44,163 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:43.81753, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:43.81753, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 43, 817530), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:44,165 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:43.81753, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:43.81753, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 43, 817530), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:44,339 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:44] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:44,679 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:45,350 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:45] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:45,361 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:45.021211, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:45.021211, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 45, 21211), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:45,363 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:45.021211, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:45.021211, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 45, 21211), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:45,364 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:45.021211, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:45.021211, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 45, 21211), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:45,539 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:45] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:45,876 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:45,876 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:46,584 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:47,112 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:47,113 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:47,320 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:46.947679, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:46.947679, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 46, 947679), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:47,322 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:46.947679, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:46.947679, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 46, 947679), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:47,324 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:46.947679, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:46.947679, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 46, 947679), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:47,517 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:47] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:47,874 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:48,562 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:48.221863, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:48.221863, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 48, 221863), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:48,563 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:48.221863, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:48.221863, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 48, 221863), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:48,565 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:48.221863, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:48.221863, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 48, 221863), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:48,739 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:48] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:49,047 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:49,047 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:49,732 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:50,270 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:50,270 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:50,419 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:50.077811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:50.077811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 50, 77811), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:50,421 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:50.077811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:50.077811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 50, 77811), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:50,423 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:50.077811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:50.077811, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 50, 77811), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:50,614 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:50] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:50,998 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:51,631 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:51] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:52,087 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:51.345108, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:51.345108, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 51, 345108), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:52,091 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:51.345108, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:51.345108, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 51, 345108), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:52,095 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:51.345108, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:51.345108, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 51, 345108), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:52,157 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:52,157 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:52,272 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:52] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:52,839 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:53,523 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:53.182837, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:53.182837, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 53, 182837), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:53,528 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:53.182837, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:53.182837, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 53, 182837), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:53,531 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:53.182837, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:53.182837, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 53, 182837), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:53,710 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:53] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:53,816 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:53,817 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:54,504 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:55,196 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:54.852219, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:54.852219, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 54, 852219), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:55,200 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:54.852219, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:54.852219, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 54, 852219), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:55,204 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:54.852219, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:54.852219, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 54, 852219), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:55,770 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:55] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:56,252 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:56,253 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:56,688 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:56,689 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:56,790 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:56] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:43:56,942 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:57,316 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:57,317 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:57,381 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:57,624 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.284993, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.284993, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 57, 284993), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:57,627 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.284993, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.284993, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 57, 284993), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:57,629 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.284993, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.284993, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 57, 284993), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:57,802 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:57] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:58,071 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.728378, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.728378, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 57, 728378), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:58,074 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.728378, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.728378, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 57, 728378), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:58,078 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.728378, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:57.728378, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 57, 728378), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:58,254 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:58] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:58,314 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:58,316 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:43:58,405 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:59,101 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:58.756667, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:58.756667, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 58, 756667), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:59,104 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:58.756667, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:58.756667, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 58, 756667), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:59,106 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:58.756667, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:43:58.756667, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 43, 58, 756667), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:43:59,283 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:43:59] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:43:59,744 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:43:59,795 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:43:59,796 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:00,482 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:44:00,801 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.459586, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.459586, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 0, 459586), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:00,805 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.459586, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.459586, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 0, 459586), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:00,807 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.459586, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.459586, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 0, 459586), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:00,815 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:44:00,815 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:00,980 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:00] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:01,165 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.825536, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.825536, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 0, 825536), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:01,169 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.825536, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.825536, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 0, 825536), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:01,170 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.825536, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:00.825536, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 0, 825536), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:01,345 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:01] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:01,513 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:44:02,196 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:01.857471, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:01.857471, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 1, 857471), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:02,198 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:01.857471, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:01.857471, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 1, 857471), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:02,200 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:01.857471, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:01.857471, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 1, 857471), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:02,360 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:02] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:44:02,375 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:02] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:02,882 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:44:02,882 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:03,922 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:44:03,923 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:03,948 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:44:04,621 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:44:04,642 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.297242, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.297242, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 4, 297242), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:04,645 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.297242, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.297242, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 4, 297242), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:04,648 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.297242, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.297242, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 4, 297242), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:04,825 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:04] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:04,928 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:44:04,928 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:05,382 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.972786, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.972786, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 4, 972786), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:05,387 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.972786, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.972786, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 4, 972786), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:05,389 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.972786, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:04.972786, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 4, 972786), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:05,565 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:05] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:05,615 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:44:06,677 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:05.962394, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:05.962394, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 5, 962394), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:06,678 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:05.962394, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:05.962394, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 5, 962394), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:06,681 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:05.962394, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:05.962394, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 5, 962394), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:06,860 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:06] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:07,110 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:44:07,111 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:07,799 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
2025-07-23 23:44:07,881 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:07] "OPTIONS /api/flow/252 HTTP/1.1" 200 -
2025-07-23 23:44:08,398 - api.flow_api - INFO - [PATCH /api/flow/252] Received raw data: {'plubotId': '252', 'flowName': 'Felizmente', 'nodes': [{'data': {'color': '#e74c3c', 'conditionId': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'instruction': 'Opción B', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción B'}, 'id': 'option-decision-290a2fc8-7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'position': {'x': 734.1648054913771, 'y': 670.8076778742713}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'id': 'message-bba9c837', 'label': 'Mensaje'}, 'id': 'message-bba9c837', 'position': {'x': 913.7399893310603, 'y': 204.74714840333556}, 'type': 'message', 'width': 212, 'height': 101}, {'data': {'id': 'start-e005d67f', 'label': 'Inicio'}, 'id': 'start-e005d67f', 'position': {'x': 543.4296307635723, 'y': 87.32228707147982}, 'type': 'start', 'width': 229, 'height': 156}, {'data': {'color': '#FFA500', 'conditionId': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'instruction': 'Nueva condición', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Nueva condición'}, 'id': 'option-decision-290a2fc8-condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'position': {'x': 1095.0620790577386, 'y': 668.7152764862268}, 'type': 'option', 'width': 320, 'height': 122}, {'data': {'conditions': [{'color': '#3498db', 'id': '4d01e941-7227-4737-9d02-317a99523646', 'text': 'Opción A'}, {'color': '#e74c3c', 'id': '7ea46816-0c8b-4c1f-8e11-84405c7ea3c2', 'text': 'Opción B'}, {'color': '#FFA500', 'condition': '', 'id': 'condition-9a7e8484-35a5-449a-a4e5-254ff557f95d', 'text': 'Nueva condición'}], 'handleIds': ['output-0', 'output-1'], 'id': 'decision-290a2fc8', 'isEditing': False, 'label': 'Decisión'}, 'id': 'decision-290a2fc8', 'position': {'x': 763.3520377967772, 'y': 386.46603814640747}, 'type': 'decision', 'width': 150, 'height': 40}, {'data': {'id': 'end-11a6ac5c', 'label': 'Fin'}, 'id': 'end-11a6ac5c', 'position': {'x': 887.4532491248175, 'y': 932.7094085152959}, 'type': 'end', 'width': 310, 'height': 132}, {'data': {'color': '#3498db', 'conditionId': '4d01e941-7227-4737-9d02-317a99523646', 'instruction': 'Opción A', 'lastUpdated': '2025-07-23T04:19:27.337Z', 'sourceNode': 'decision-290a2fc8', 'text': 'Opción A'}, 'id': 'option-decision-290a2fc8-4d01e941-7227-4737-9d02-317a99523646', 'position': {'x': 377.4523347011048, 'y': 674.9924806503606}, 'type': 'option', 'width': 320, 'height': 122}], 'edges': [{'zIndex': 0, 'source': 'message-bba9c837', 'sourceHandle': 'default', 'target': 'decision-290a2fc8', 'targetHandle': None, 'id': 'reactflow__edge-message-bba9c837default-decision-290a2fc8'}]}
2025-07-23 23:44:08,399 - api.flow_api - INFO - [PATCH /api/flow/252] Extracted: nodes_count=7, edges_count=1, name='N/A'
2025-07-23 23:44:08,488 - utils.transaction_utils - ERROR - Error al actualizar flujo completo
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:08.146006, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:08.146006, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 8, 146006), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:08,490 - utils.transaction_utils - ERROR - Error al actualizar flujo (PATCH) para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:08.146006, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 49, in atomic_transaction
    yield session
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:08.146006, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 8, 146006), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:08,491 - api.flow_api - ERROR - Error inesperado en PATCH para plubot 252
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:08.146006, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/flap/Desktop/Plubot/plubot-backend/api/flow_api.py", line 311, in patch_flow
    update_full_flow(session, plubot_id, flow_data_for_update)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 99, in wrapper
    with atomic_transaction(session, error_message):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/Users/flap/Desktop/Plubot/plubot-backend/utils/transaction_utils.py", line 50, in atomic_transaction
    session.commit()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1972, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1257, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1232, in _prepare_impl
    self.session.flush()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4296, in flush
    self._flush(objects)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4431, in _flush
    with util.safe_reraise():
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4392, in _flush
    flush_context.execute()
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1422, in execute
    return meth(
           ^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1644, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1850, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1990, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2357, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1971, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/homebrew/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 919, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "edge_type" of relation "flow_edges" violates not-null constraint
DETALLE:  Failing row contains (10573, 252, 20401, 20404, , null, null, null, 2025-07-24 02:43:17.851572, 2025-07-24 02:44:08.146006, f, reactflow__edge-message-bba9c837default-decision-290a2fc8, default, null, null, t).

[SQL: UPDATE flow_edges SET edge_type=%(edge_type)s, target_handle=%(target_handle)s, updated_at=%(updated_at)s WHERE flow_edges.id = %(flow_edges_id)s]
[parameters: {'edge_type': None, 'target_handle': None, 'updated_at': datetime.datetime(2025, 7, 24, 2, 44, 8, 146006), 'flow_edges_id': 10573}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-23 23:44:08,667 - werkzeug - INFO - 127.0.0.1 - - [23/Jul/2025 23:44:08] "[35m[1mPATCH /api/flow/252 HTTP/1.1[0m" 500 -
2025-07-23 23:44:09,088 - api.flow_api - INFO - [update_full_flow - plubot_id=252] Starting update. Received: nodes_count=7, edges_count=1, name='None'
